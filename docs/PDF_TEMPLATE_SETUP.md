# PDF Template Setup Guide

## Overview
The Students Management system now uses your custom PDF template (`soccs_reporting_format.pdf`) as a background for section reports.

## What Was Installed

### Required Libraries
1. **FPDF Library**
   - **Library:** `setasign/fpdf` (v1.8.2)
   - **Purpose:** Base PDF generation library
   - **Installation:** Via Composer

2. **FPDI Library**
   - **Library:** `setasign/fpdi` (v2.6.4)
   - **Purpose:** Extends FPDF to load existing PDF files and add dynamic content on top
   - **Dependency:** Requires FPDF
   - **Installation:** Via Composer

## Files Created/Modified

### New Files:
1. **`pages/print-section-report-pdf.php`** - Main PDF generator with template background
2. **`.gitignore`** - Excludes vendor directory and uploads from git
3. **`composer.json`** - Composer dependencies file
4. **`composer.lock`** - Locked versions of dependencies
5. **`vendor/`** - Composer packages directory

### Modified Files:
1. **`assets/js/students.js`** - Updated to call the new PDF endpoint

## How It Works

### 1. PDF Template Loading
```php
$templatePath = '../assets/img/soccs_reporting_format.pdf';
$pageCount = $pdf->setSourceFile($templatePath);
$template = $pdf->importPage(1);
```

### 2. Template Usage
```php
$pdf->AddPage('P', 'A4');
$pdf->useTemplate($template, 0, 0, 210);
```

### 3. Dynamic Content Overlay
The system overlays:
- Report header with section information
- Report date, generated by, report type
- Summary statistics (Total, Paid, Unpaid)
- Paid students table
- Unpaid students table
- Footer with system information

## Content Positioning

All content is positioned using coordinates (X, Y) in millimeters:

### Report Header
- **Title:** Centered at Y=35mm
- **Subtitle:** Centered at Y=45mm

### Report Info
- **Left column:** X=30mm, Y=65mm
- **Middle column:** X=85mm, Y=65mm
- **Right column:** X=140mm, Y=65mm

### Summary Statistics
- **Background box:** 25mm left margin, 160mm wide
- **Stats cards:** Evenly distributed across width

### Tables
- **Column widths:**
  - Student ID: 20mm
  - Full Name: 65mm
  - Course: 20mm
  - Year: 15mm
  - Section: 15mm

### Footer
- **Position:** Y=280mm (bottom of page)
- **System info:** Left aligned
- **Page number & timestamp:** Right aligned

## Auto Page-Break

The system automatically creates new pages when content exceeds 260mm:
```php
if ($currentY > 260) {
    $pdf->AddPage('P', 'A4');
    $pdf->useTemplate($template, 0, 0, 210);
    $currentY = 30;
}
```

## Customization Guide

### Adjusting Text Position
Find the section you want to modify and change the `SetXY()` values:
```php
$pdf->SetXY(30, 72);  // X=30mm, Y=72mm
$pdf->Cell(50, 6, 'Your Text', 0, 0, 'L');
```

### Changing Colors
Use `SetTextColor()` and `SetFillColor()`:
```php
$pdf->SetTextColor(153, 51, 255);  // RGB purple
$pdf->SetFillColor(248, 249, 250);  // RGB light gray
```

### Modifying Fonts
```php
$pdf->SetFont('Arial', 'B', 12);  // Font family, style (B=bold), size
```

## Testing

1. Go to **Student Management** page
2. Filter by section (e.g., enter "A")
3. Click **"Apply Filters"**
4. Click **"Print Report"** on the section summary card
5. PDF should open in new tab with your template as background

## Troubleshooting

### "Template PDF not found" Error
- Verify file exists at: `assets/img/soccs_reporting_format.pdf`
- Check file permissions

### Content Not Showing
- Adjust Y positioning (may be outside visible area)
- Check if text color matches background color

### Composer Errors
```bash
composer install
composer dump-autoload
```

### Missing Vendor Directory
```bash
composer install
```

## File Structure
```
project/
├── assets/
│   └── img/
│       └── soccs_reporting_format.pdf  (Your template)
├── pages/
│   └── print-section-report-pdf.php   (PDF generator)
├── vendor/                             (Composer packages)
│   └── setasign/fpdi/
├── composer.json                       (Dependencies)
└── .gitignore                         (Exclude vendor from git)
```

## Notes

- Template PDF must be A4 size (210mm x 297mm)
- Content is overlaid on page 1 of the template
- Multiple pages use the same template background
- Output is inline (opens in browser), not downloaded
- All measurements use millimeters (mm)
- Coordinate system: (0,0) is top-left corner

## Future Enhancements

Possible improvements:
1. Different templates for different report types
2. Configurable positioning via admin settings
3. Multi-language support
4. Email PDF functionality
5. Bulk PDF generation for multiple sections

